package com.github.aoc

import scala.collection.mutable.ListBuffer

object Day19 {
  
  val ex = 
"""     |          
        |  +--+    
        A  |  C    
    F---|----E|--+ 
        |  |  |  D 
        +B-+  +--+"""
  
  val lines = List(
"     |          ",
"     |  +--+    ",
"     A  |  C    ",
" F---|----E|--+ ",
"     |  |  |  D ",
"     +B-+  +--+ " )

  val data = List("                                                           |                                                                                                                                             ",
"                                       +-----------------------------------+       +-+         +-------------------------------------------------------------------------------------------+   +-+       ",
"                                       |                   |               |       | |         |                                                                                           |   | |       ",
"                                       +-----------------+ |       +-----+ | +-----+ |         |                                             +---------------------------------------------|---+ |       ",
"                                                         | |       |     | | |       |         |                                             |                                             |     |       ",
"                                                         +-------------+ +-+ |       |         | +---------------+                           |                                             |     |       ",
"                                                           |       |   |     |       |         | |               |                           |                                             |     |       ",
"               +---------------------------------------------------------------------|---------|-----------+     |                           |                       +---------------------|-----+       ",
"               |                                           |       |   |     |       |         | |         |     |                           |                       |                     |             ",
"               |                                           |       +-----+ +-------------------+ +-+       +-------------------------------------------------------------------------------------------+ ",
"               |                                           |           | | | |       |             |             |                           |                       |                     |           | ",
"               |                                   +-------|-------+   | +-|-+   +---|-------------------------------------------------------|---------------------------------------------|---+       | ",
"               |                                   |       |       |   |   |     |   |             |             |                           |                       |                     |   |       | ",
"               |                                   |       |       |   | +-|-----|---------+       +-----------------------------------------------------------------|-------------------------|---+   | ",
"               |                                   |       |       |   | | |     |   |     |                     |                           |                       |                     |   |   |   | ",
"               |                     +-----------------------------|---|---|-----|---|-------------------------------------------+           |   +-------------------|-------------------------+ +-+   | ",
"               |                     |             |       |       |   | | |     |   |     |                     |               |           |   |                   |                     |     |     | ",
"               |     +---------------|-------------|-------|-------------|-----------|-----|-------------------------------------|-----------------------------------|---------------------------+ +-+ | ",
"               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |                   |                     |       | | | ",
"               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |               +---|---+             +-----------+ +-+ ",
"               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |               |   |   |             |   |             ",
"               |     | +-------------|---------------------|-------|-----|-----------|-----|---------------------|---------------|---------------|-------+       |   |   |             |   |             ",
"               |     | |             |             |       |       |   | | |     |   |     |                     |               |           |   |       |       |   |   |             |   |             ",
"               | +---|-|---------------------------|---------------|---+ | |     +---|-----|-----------------+   |               |       +---|-------------+     |   |   |             |   | +-+         ",
"               | |   | |             |             |       |       |     | |         |     |                 |   |               |       |   |   |       | |     |   |   |             |   | | |         ",
"               | |   | |             |             |       |       |     | |         |     |                 | +-------------------+     +-+ |   +-----------------------------------+ |   | | |         ",
"               | |   | |             |             |       |       |     | |         |     |                 | | |               | |       | |           | |     |   |   |           | |   | | |         ",
"               | |   +---------------|-------------|---------------|-------|---------|-----|-+               | | |               | |       | |           | | +-----------|-------------+   | | |         ",
"               | |     |             |             |       |       |     | |         |     | |               | | |               | P       | |           | | |   |   |   |           |     | | |         ",
"               | |     |             |             |       |       |     | |       +-|-------------------------|-|---------------|-|---------|-----------|-------|-------|-----------+     | +-------+   ",
"               | |     |             |             |       |       |     | |       | |     | |               | | |               | |       | |           | | |   |   |   |                 |   |     |   ",
" +-------------+ |     |             |           +---------|---------------|-------|-|-----|-----------------|-|-|---+           | |       | |           | | |   |   |   |             +-----+ |     +-+ ",
" |               |     |             |           | |       |       |     | |       | |     | |               | | |   |           | |       | |           | | |   |   |   |             |   | | |       | ",
" +-----+         |     |             |           | |       |       |     | +---------------|-----------------|-|-|-------------------------------------------|---|---|---------------------|-------+   | ",
"       |         |     |             |           | |       |       |     |         | |     | |               | | |   |           | |       | |           | | |   |   |   |             |   | | |   |   | ",
"       |         |     |             |     +---------------|-------------|---------|-|-----|-------+         | | |   |           | |     +---|-------------+ |   |   |   |             |   | +-+   |   | ",
"       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |           |   |   |   |   |             |   |       |   | ",
"       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |           +-------|---------------------|---|-+   +---+ | ",
"       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |             |   | |   | | | | ",
"       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |   +---------|---|-+   | | | | ",
"       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |   |         |   |     | | | | ",
" +---------------------|-------------|-----|-----|-|-------|-------|---------------|-|-----|-|-----|---------|---|---|-------------|-+   | | |               |   +---|---|-------------|-----+   | | | | ",
" |     |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | | |   | | |               |       |   |   |         |   | |   | | | | ",
" |     +---------+     |             |     |     | |   +---|-+     |     |         | |     | |     |         | | |   |           | | |   | | |     +---------|---+   |   +---|-+       |   | |   | | | | ",
" |                     |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | ",
" |     +-----------------+           |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | ",
" |     |               | |           |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | ",
" |     |               | +-----------|-----|-----|-----|---|-|-----|---------------|-------|-|-----------------------|---------------------+ |     |         |   |   |       | |       |   | |   | | | | ",
" |     |               |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |       | |       |   | |   | | | | ",
" |     |     +-+       |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |   +---|-|-----------|-----+ | | | ",
" |     |     | |       |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |   |   | |       |   | |     | | | ",
" |     |     | |     +---+           |     |     | |   |   | |     +-----+         | |   +-|-+   +-------------|-|---|-----------|-------|---|---+ |         |   |   |   | +-+ |       |   | +---------+ ",
" |     |     | |     | | |           |     |     | |   |   | |                     | |   | |     | |         | | |   |           | | |   |   |   | |         |   |   |   | |   |       |   |       | |   ",
" |     |     | |     | | |           |     |   +-|-|---|---|-|---------------------|-----|-|---------------------|-----------------|-----|---------+         |   |   |   | |   |       |   |       | |   ",
" |     |     | |     | | |           |     |   | | |   |   | |                     | |   | |     | |         | | |   |           | | |   |   |   |           |   |   |   | |   |       |   |       | |   ",
" |     |     | |     | | |           |     +---+ | |   |   | |                     | |   | |     | |         | | |   |           | | | +-|-------------------|-----------|-+   |       |   |       | |   ",
" |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   |   |           |   |   |   |     |       |   |       | |   ",
" |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   | +-----------------|-------|-----------+ |   |       | |   ",
" |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   ",
" |     |     | |     | | +-----------|-----------------|---|-|-------------+       | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   ",
" |     |     | |     | |             |           | |   |   | |             |       | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   ",
" |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | +-------|-|-|---|-----------------|---------|---------------|-+ |   |     |     | |   |       | |   ",
" |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | | |   |           | | | | |   | | |           |   | | |   |     |     | |   |       | |   ",
" |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | | +---|-------------|---|-|---|---------------|---|-|-----+     |     | |   |       | |   ",
" |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | |     |           | | | | |   | | |           |   | | |         |     | |   |       | |   ",
" |     |     | |     +---------------|-----------|-----|-+ | |             |       | |   | |     | | |       | |   +-|-----------|-------|---|-|-+           |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   | +---|-------------------------+ | +-----|-----------|-------|-----------|-|-|-------|---------------|-+ | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   |   | |             |       | | | |       | | |       | |   | |           | | | | |   | |             | | | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   |   | |             |       | | | |       +-------------|---|-------------|-|---|-|---------+         | | | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   ",
" |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   ",
" |     |     | |     +---------------|-------------|---|-----+     +-------|-------|-----|---------|-----------|---|-|-------------|-|-|-|-----|-------------|-|-|-|-----------|-----|-------+     | |   ",
" |     |     | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | +---|-+   | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | |   | |   | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | | +---|-----|-----|-----------------+         | |   | +---------|-+     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | |         | +-+ | | |       | |     +-----+ | | | |         | |       | |   | |           | | | +-|-+ | +-+ |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | |         |   | | | |       | |           | | | | |         | |       | |   | |           | | |   | | |   | |         | | | | |         |     | |   | |     | |   ",
" | | | | |   | |     | |             | | +-------|-------------------|-----------|---|------------Y--|-------------|---------------|-----|---|-----|---------|---|-----------+ |     | |   | |     | |   ",
" | | | | X   | |     | |             | | |       |   | | | |       | |           | | | | |         | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |   | |     | |   ",
" | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | +---------|---------------------------------------|-----|-----------|---|---------|-|-----------+ |     | |   ",
" | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | |   ",
" | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | +-+ ",
" | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     |   | ",
" | | | | |   | |     +-|-------------------------|-----|-----------|-|-----------|---|-------------|---------|-|---|-|-----------|---------|-|---------------------|-|---------|-------|-----------|-+ | ",
" | | | | |   | |       |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | | | ",
" | | | | |   | |       |             | | |       |   | +-|---------|-------------|-|-|-------------|---------|-|-----------------|-------+ | |   | |         | | | | |       | |     | |     |     | | | ",
" | | | | |   | |       |             | | |       |   |   | |       | |           | | | | | |       | |       | |   | |           | | |     | |   | |         | | | | |       | |     | |     |     | | | ",
" | +-----------|-----------------------|-|---+   | +---------------|-------------|---|-|-+ |       | |       | |   | |   +-------|---|-----|-|-+ | |         | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           | | | |   |       | |       | |   | |   |       | | |     | | | | |         | | | | |       | |     | |     O     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           | +-|-----|-----------------|-|---|-+   |       | | |     | | | | |         | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |   |       | |       | |   |     |       | | |     | | | | |         | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |   +---------|-------|-|---|-----------------------|-|-|-|---+       | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | R |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | ",
" |   | | |   | |       |             | | |   |   | | | +-|---------|-|---------------|-------------|-+       | |   |     |       | | | +-----|-|-|-|-|-------|-|-|-----------|-|-----|-|---+ |     | | | ",
" |   | | |   | |       |             | | |   |   | | | | | |       | |           |   | |           |         | |   |     |       | | | |   | | | | | |       | | | | |       | |     | |   | |     | | | ",
" |   | | |   | |       |             | | |   +---|-|---+ | +---------|-----------|-----------------|---------|-----------------------|-----|-+ | | | | +---------|---|---+   | |     | |   | |     | | | ",
" |   | | |   | |       |             | | |       | | |   |         | |           |   | |           |         | |   |     |       | | | |   |   | | | | |     | | | | |   |   | |     | |   | |     | | | ",
" |   | | |   | |       |             | | |       | +-----|---------|-|---------------|-------------|-----------|---|-----|-----------|---------|-|---+ +-+   +-----|-|---------------+ |   | |     | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |           W         | |   |     |       | | | |   |   | | |     |     | | | |   |   | |       |   | |     | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |           |         | |   |     |   +---|-----|-------|---|---+ |   +-|-|---|-------|-|-------|-----|-+   | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |           |         | |   |     |   |   | | | |   |   | | |   | |   | | | | |   |   | |       |   | | |   | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |   +-------+         | |   |     |   |   | | +-|---------------------|---|-|-|---|-+ | |       |   | | |   | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | |   | |   | | | | |   | | | |       |   | | |   | | | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | | +-------------|-|---|---|-|-------+   | | +-----+ | ",
" |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | | | | |   | | | | |   | | | |           | |     |   | ",
" |   | | |   | |       |             | | |     +-|-------|---------|-+           | +---+   |                 | | +-|-----|---------+ +-|-------------+ | |   | | | | |   | | | |           | |     |   | ",
" |   | | |   | |       |             | | |     | |   |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | |   | |   | | | | |   | | | |           | |     |   | ",
" |   | | | +-|-|-------|---------------|-------|-|-----------------|-------------|---|-----|-----------------|-|-|-|-----|-----------|-----|---|---|---|-|-----------|-----|-|-------------------------+ ",
" |   | | | | | |       |             | | |     | |   |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | |   | |   | | | | |   | | | |           | |     |     ",
" |   | | | +-------+   |             | | |   +-+ +-------|---------|-------------|---|-----------------------|-----|-----|-------|---|-----|-----|---+ | | +---|-+ | |   | | | |           | | +-------+ ",
" |   | | |   | |   |   |             | | |   |       |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | | | | | | | |   | |   | | | |           | | |   |   | ",
" |   | | |   | |   |   |             | +-----|-------|---+         |             | | |     |       +---+     | | | |     |   |   +---|-|---|-------|---|-----|-|---|---------|-----------+ | | |   |   | ",
" |   | | |   | |   |   |             |   |   |       |             |             | | |     |       |   |     | | | |     |   |       | |   |   | | | | | | | | |   | |   | | | |         | | | |   |   | ",
" |   | | |   | |   |   |             |   |   |       |             |             | | |     |     +-|-------------|-----------|---------------+ +-|-----|-+ +---|-----|---|-|-------------|---|-+   |   | ",
" |   | | |   | |   |   |             |   |   |       |             |             | | |     |     | |   |     | | | |     |   |       | |   | |   | | | |     | |   | |   | | | |         | | |     |   | ",
" |   | | |   +---------|-------------|-----------------------------------------------|-----|-------|---|-----|-----------|---|-------|-----|-|---|---+ |     | | +-|-|---|---|---------------|-+   |   | ",
" |   | | |     |   |   |             |   |   |       |             |             | | |     |     | |   |     | | | |     |   |       | |   | |   | |   |     | | | | |   | | | |         | | | |   |   | ",
" |   | | |     |   |   |             |   |   |       |   +-----------------------|-|-|-----------------------|---|-|-----|-----------|-|-----------------------|-|-------+ | | |   +-----|---|-|---|---+ ",
" |   | | |     |   |   |             |   |   |       |   |         |             | | |     |     | |   |     | | | |     |   |       | |   | |   | |   |     | | | | |     | | |   |     | | | |   |     ",
" |   | | |     |   |   |             |   |   |       |   +---+     |             | +-|-------------+   |     | | | |     |   | +-----+ |   | |   | |   |     | | | | |     | | |   |     | | | |   |     ",
" |   | E |     |   |   |             |   |   |       |       |     |             |   |     |     |     |     | | | |     |   | |       |   | |   | |   |     | | | | |     | | |   |     | | | |   |     ",
" |   | | |     |   |   |             |   |   |       |       |     | +-----------+   |   +-+     |     |     | | | |     |   | |       |   | | +-+ |   |     | | | | |     | | |   | +---|---|-+   |     ",
" |   | | |     |   |   |             |   |   |       |       |     | |               |   |       |     |     | | | |     |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |     ",
" |   | | |     |   |   |             |   |   |       |       +-----------------------|---|-------|-----|-----------------------------------|-|---------------|-------|-----|---|---------|-|-----------+ ",
" |   | | |     |   |   |             |   |   |       |             | |               |   |       |     |     | | | |     |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | ",
" | +-|---------|---|---------------------|---|-------|-----------------------+       |   |     +-------------|---------+ |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | ",
" | | | | |     |   |   |             |   |   |       |             | |       |       |   |     | |     |     | | | |   | |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | ",
" | | | | |     |   |   |             |   |   |       |     +-----------+     |     +-----|-----|---+   |     +-|-------|-|-----------------|-|---------|-------|-|-------------------|---|-------+ | +-+ ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |   | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |       +-------|---|---------|-|-|---------|-|-|-----|-----|-|-+ | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |           | | |   |   |     | | | | |     | | |   | |   | | | | | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   +-----|-------------|-------------|-----------|-|-|---|---|---------|---|---------|---|-|-----+ | | | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |   |       | | |   | |   | |           | | |   |   |     | | | | |     | | |   | |   |   | | | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |   +-----------|-----|-----|---------+ | | |   |   |     | | | | |     | | |   | |   |   | | | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |           | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   ",
" | | | | | +-----------------------------------------------|-------|---|-----|-----------------------+         | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   ",
" | | | | | |   |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | | |         | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   ",
" | | | | | +-------------------------------------------------------|-|-------|---+ | |   | +-|-----|-------------|-|---|-|---|---------------|-|---|---|-------------|-+   | | |   | |   |   | | | | |   ",
" | | | | |     |   |   |             |   |   |       |     |       | | |     |   | | |   | | | | | | |         | | |   | |   | |         | | | |   |   |     | | | | | |   | | |   | |   |   | | | | |   ",
" | | | | |     |   |   |             |   |   |       |   +-|-----------|-----------|-----|---+ | | | |         | | |   +-----|-|-----------+ | |   |   |     | | | | | |   | | |   | |   |   | | | | |   ",
" | | | | |     |   |   |             |   |   |       |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |   |     | | | | | |   | | |   | |   |   | | | | |   ",
" | +---|---------------------------------|---|-+ +---|---|-|-------|-|-----------|-|-|--H--------|---|-------------------|---|-|-----------------------+     | | | | | |   | | |   | |   |   | | | | |   ",
" |   | | |     |   |   |             |   |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |         | | | | | |   | | |   | |   |   | | | | |   ",
" |   | | |     |   |   |             | +-----|-|-|-------|-|---------|-|---------|---|---|-------|---|-------------|-----|-------------------|-----|---------|-|-------|-----|-----+ |   |   | +-|---+   ",
" |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |         | | | | | |   | | |     |   |   |   | |     ",
" |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | +-------------+         |   | |   |   +-+   | | | | +-|---|-|-------|---|-------|-|-+   ",
" |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |   | | | |   |   | | |     |   |   |   | | |   ",
" |   | | |     |   +---------------------|---|-|-----|-------------|-------------------------------|-|-------------|---------|---------------------------|---+ | | |   |   | | |     |   |   |   | | |   ",
" |   | | |     |       |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |     | | |   |   | | |     |   |   |   | | |   ",
" |   | | |     |       |             | | |   | +-----|-----|-------|---|-----------------|-|---|---|-|-----------------------------------|---------|---|-------|---+   |   | | |     |   +-----+ | | |   ",
" |   | | |     |       |             | | |   |   |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |     | |     |   | | |     |       | | | | |   ",
" |   | | |     |       |             | +-|---------------|-+       | | |     +-------|---|-----------|-----------+ |     |   |     +---------|-----|---|-------|-|-+   |   | | |     |       | | | | |   ",
" |   | | |     |       |             |   |   |   |   |   |         | | |         | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   ",
" |   | | |     |       |             | +-------------|---|-------------+         | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   ",
" |   | | |     |       |             | | |   |   |   |   |         | |           | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   ",
" |   | | |     |       |   +---------|-|-|-------------------------|-----------------|---|-------|-|-------------|-|-----|---------|-----|---------|---|-------|-+ |   |   | | |     |       | | | | |   ",
" |   | | |     |       |   |         | | |   |   |   |   |         | |           | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |   | | |     |       | | | | |   ",
" | +-|-|-------|-------|-------------|-------|---+   |   |         | |   +-----------+   | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |   +-----+   |       | | | | |   ",
" | | | | |     |       |   |         | | |   |       |   |         | |   |       | |     | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |     | | |   |       | | | | |   ",
" | | | | |   +-|-----------+         | | |   |       |   |         | |   |       | +-+   | |   | | | |         | +-|-------+ |     |     | +-------|---------------|---------|---+   |       | | | | |   ",
" | | | | |   | |       |             | | |   |       |   |         | |   |       |   |   | |   | | | |         |   |     | | |     |     | | | |   |   | |     |   |   |     | |     |       | | | | |   ",
" | | | | |   | |   +-----------+     | | |   |       |   |         | |   |       +---|-------------|-----------|-------------|-----------|-|---|---------+     |   |   |     | |     |       | | | | |   ",
" | | | | |   | |   |   |       |     | | |   |       |   |         | |   |           |   | |   | | | |         |   |     | | |     |     | | | |   |   |       |   |   |     | |     |       | | | | |   ",
" | | | | | +-|-----+   |       |     | | |   |       |   |     +---------------------|---|-|---|-|---|-------------|-----|---|-----|-------|-|-|---------------|---------------|-----------------|---+   ",
" | | | | | | | |       |       |     | | |   |       |   |     |   | |   |           |   | |   | | | |         |   |     | | |     |     | | | |   |   |       |   |   |     | |     |       | | | |     ",
" | | | | | | | |       |       |     | | | +-|-------|---|-----------|---------------+   | +---|-|-+ +-+       |   |     | +-------+   +-+ | | |   |   |       |   | +-------+ |     |       | | | |     ",
" | | | | | | | |       |       |     | | | | |       |   |     |   | |   |               |     | |     |       |   |     |   |         |   | | |   |   |       |   | | |       |     |       | | | |     ",
" | | | | +-|-|-----------------+   +---+ | | |       |   |     +---|-|---|---------------------|-------|-------------------------------|---|-|-----|---|-------|-+ | | |   +---|-----|-+     | | | |     ",
" | | | |   | | |       |           | |   | | |       |   |         | |   |               |     | |     |       |   |     |   |         |   | | |   |   |       | | | | |   |   |     | |     | | | |     ",
" | | | |   | | |       |           +-|-----|---------|-------------|-|-------------------------|-|-------------|-------------|---------|-----|-|---|---|-----+ | +-|-+ |   |   | +---+ |     | | | |     ",
" | | | |   | | |       |             |   | | |       |   |         | |   |               |     | |     |       |   |     |   |         |   | | |   |   |     | |   |   |   |   | |     |     | | | |     ",
" | +-|-|---|-|---------|-------------|---|-----------|---|-----------|-----------------+ |     | |   +-|---------+ |     |   |   +-----|-----|-|---|-----------|---|-------|---|-|-----+     | | | |     ",
" |   | |   | | |       |             |   | | |       |   |         | |   |             | |     | |   | |       | | |     |   |   |     |   | | |   |   |     | |   |   |   |   | |           | | | |     ",
" | +-|-|-+ | | |       |             +-----|-|-------|---------------------------------|-------|-------+       +---------+   +---|-----|---|-|-|---+   |     +---------+   |   | |           | | +-|---+ ",
" | | | | | | | |       |                 | | |       |   |         | |   |             | |     | |   |           | |             |     |   | | |       |       |   |       |   | |           | |   |   | ",
" | +-|-+ +-----|-------------------------|---|-------+   |         | |   |             +---------|-----+         | |       +---------------|---|-------|-------|---|-----------|-------------|-----|---+ ",
" |   |     | | |       |                 | | |           |         | |   |               |     | |   | |         | |       |     |     |   | | |       |       |   |       |   | |           | |   |     ",
" | +---+   | +---------|---------------------|-----------------------|---|---------------|-----|-----------------+ |       | +---------+   | | |       |       |   |       |   | |           | |   |     ",
" | | | |   |   |       |                 | | |           |         | |   |               |     | |   | |           |       | |   |         | | |       |       |   |       |   | |           | |   |     ",
" | +-|-|-------|-------+                 | | +-----------|---------|-|---|-----------------------|-----|-----------|---------|---|---------|---|-------------------|-------------|-----------+ |   |     ",
" |   | |   |   |                         | |             |         | |   |               |     | |   | |           |       | |   |         | | |       |       |   |       |   | |             |   |     ",
" +---+ |   |   |           +-------------+ +-----------------------|-+   |               |   +---|---+ +-----------|-------|-----|-----------|-|-------+       +---|-------+   | +-----------+ |   |     ",
"       |   |   |           |                             |         |     |               |   | | |                 |       | |   |         | | |                   |           |             | |   |     ",
"       +---+   +-----------+                             |         |     +---------------+   +-+ +-----------------+       | |   +-----------|-------------------+ |           |             | |   |     ",
"                                                         |         |                                                       | |             | | |                 | |           |             | |   |     ",
"                                             +-----------|-----------------------------------------------------------------|-|-------------|---|-----------------+ +---+       |             | |   |     ",
"                                             |           |         |                                                       | |             | | |                       |       |             | |   |     ",
"                                             +-----------+         +-------------------------------------------------------+ +---N         +-+ +-----------------------+       +-------------+ +---+     " )
 


  class Direction( val x : Int, val y : Int )
  case class East() extends Direction( 1, 0 )
  case class South() extends Direction( 0, 1 )
  case class West() extends Direction( -1, 0 )
  case class North() extends Direction( 0, -1 )
  
  type Grid = Array[Array[Char]]
  type YX = (Int,Int)
  
  
  def main( args : Array[String] ) : Unit = {
    Console.println( "day 19..." )
    val g = convert( data )
    print(g)
    Console.println( findOrigin(g) )
    val path = walk( findOrigin(g), g )
    Console.println(path)
  }
  
  def findOrigin( grid : Grid ) : YX = {
    
    val x = grid(0).indexOf('|')
    
    (0,x)
    
  }
  
  def walk( start : YX, grid : Grid ) : List[Char] = {
    val res = ListBuffer[Char]()
    
    var steps = 0
    var pos = start
    var currDir : Direction = South()
    var continue = true
    while( continue ){
      
      // get the char at pos 
      val c = grid(pos._1)(pos._2)
      Console.println(c)
      
      c match {
        case '|' => {
          // keep going in same dir
          pos = (pos._1 + currDir.y, pos._2 + currDir.x)
          steps = steps + 1
        }
        case '-' => { 
          // keep going in same dir
          pos = (pos._1 + currDir.y, pos._2 + currDir.x)
          steps = steps + 1
        }
        case '+' => { 
          // turn
          val newDir = turn( grid, pos, currDir )
          Console.println( "turn:" + newDir )
          if( newDir.isDefined ){
            currDir = newDir.get
            pos = (pos._1 + currDir.y, pos._2 + currDir.x)
            steps = steps + 1
          }
          else {
            continue = false
          }
        }
        case cc if( c >= 'A' && c <= 'Z' ) => { 
          // log it and keep going in same dir
          res +=cc
          pos = (pos._1 + currDir.y, pos._2 + currDir.x)
          steps = steps + 1
          
          // is this the end
        }
        case _ => {
          Console.println( "hmmm:" + c )
          continue = false
        }
        
      }
      
    }
    
    Console.println( "Steps:" + steps )
    res.toList
  }
  
  def turn( grid : Grid, pos : YX, currDir : Direction ) : Option[Direction]  = {
    
    // if the current dir is N/S - we turn either E/W
    // and the reverse
    
    val newDir = currDir match {
      case South() => { eastOrWest( grid, pos ) }
      case North() => { eastOrWest( grid, pos ) }
      case East() => { southOrNorth( grid, pos ) }
      case West() => { southOrNorth( grid, pos ) }
    }
    
    newDir
  }
  
  def isChar( c : Char ) : Boolean = {
    c >= 'A' && c <= 'Z' 
  }
  
  def isValid( s : Char)( c : Option[Char] ) : Boolean = {
    if( c.isDefined ){
      c.get == s || isChar( c.get )
    }
    else {
      false
    }
  }
  
  val isDash = isValid( '-' )(_)
  val isBar = isValid( '|' )(_)
  
  def oneOrTwo( d1 : Direction)(d2 : Direction)( comp : (Option[Char]) => Boolean )( grid : Grid, pos : YX ) : Option[Direction] = {
    
    // get the pos to the east
    val e = (pos._1 + d1.y, pos._2 + d1.x )
    val w = (pos._1 + d2.y, pos._2 + d2.x )
    
    val ec = charAt( grid, e )
    val wc = charAt( grid, w )
    
    if( comp( ec ) ){
      Some(d1)
    }
    else if( comp( wc ) ){
      Some(d2)
    }
    else {
      None
    }
  }
  
  val eastOrWest = oneOrTwo(East())(West())(isDash)( _, _ )
  val southOrNorth = oneOrTwo(South())(North())(isBar)( _, _ )
  
  def charAt( grid : Grid, pos : YX ) : Option[Char] = {
    
    val (y,x) = pos
    
    if( y >= grid.size || y < 0 ){
      None
    }
    else if( x >= grid(0).size || x < 0 ){
      None
    }
    else {
      Some(grid(y)(x))
    }
    
  }
  
  def northOrSouth( grid : Grid, pos : YX ) : Direction = {
    South()
  }

  def convert( lines : List[String] ) : Grid = {
    
    val y = lines.size
    val x = lines(0).size
    Console.println( "x:"+ x +" y:" + y ) 
    
    val grid = Array.ofDim[Char](y,x)
    
    for( yy <- 0 until y ){
      for( xx <- 0 until x ) { 
        val c = lines(yy)(xx)
        grid(yy)(xx) = c
      }
    }
    
    grid
    
  }
  
  
  
  def print( grid : Grid ) : Unit = {
    
    val my = grid.size
    val mx = grid(0).size
    
    for( y <- 0 until my ){
      for( x <- 0 until mx ) {
        Console.print( grid(y)(x) )
      }
      Console.print( '\n')
    }
    Console.print( '\n')
    
  }

}